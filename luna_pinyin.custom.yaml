# luna_pinyin.custom.yaml
# ã€æœ™æœˆæ‹¼éŸ³ã€‘ç”¨æˆ·è®¾å®š
# ä½ç½®ï¼š  ~/Library/Rime  (macOS)
# æ–¼é‡æ–°éƒ¨ç½²å¾Œç”Ÿæ•ˆ

patch:
# é»˜è®¤è¼¸å‡ºç®€åŒ–å­—
  switches:                   # æ³¨æ„ç¸®é€²
    - name: ascii_mode
      reset: 0                # reset 0 çš„ä½œç”¨æ˜¯ç•¶å¾å…¶ä»–è¼¸å…¥æ–¹æ¡ˆåˆ‡æ›åˆ°æœ¬æ–¹æ¡ˆæ™‚ï¼Œ
      states: [ ä¸­æ–‡, è¥¿æ–‡ ]  # é‡è¨­çˆ²æŒ‡å®šçš„ç‹€æ…‹ï¼Œè€Œä¸ä¿ç•™åœ¨å‰ä¸€å€‹æ–¹æ¡ˆä¸­è¨­å®šçš„ç‹€æ…‹ã€‚
    - name: full_shape        # é¸æ“‡è¼¸å…¥æ–¹æ¡ˆå¾Œé€šå¸¸éœ€è¦ç«‹å³è¼¸å…¥ä¸­æ–‡ï¼Œæ•…é‡è¨­ ascii_mode = 0ï¼›
      states: [ åŠè§’, å…¨è§’ ]  # è€Œå…¨ï¼åŠè§’å‰‡å¯æ²¿ç”¨ä¹‹å‰æ–¹æ¡ˆä¸­çš„ç”¨æ³•ã€‚
    - name: simplification
      reset: 1                # å¢åŠ é€™ä¸€è¡Œï¼šé»˜èªå•“ç”¨ã€Œç¹â†’ç°¡ã€è½‰æ›ã€‚
      states: [ æ¼¢å­—, æ±‰å­— ]

# Emoji è¡¨æƒ…
  switches/@next:
    name: emoji_suggestion
    reset: 1
    states: [ "ğŸˆšï¸ï¸\uFE0E", "ğŸˆ¶ï¸ï¸\uFE0F" ]
  'engine/filters/@before 0':
    simplifier@emoji_suggestion
  emoji_suggestion:
    opencc_config: emoji.json
    option_name: emoji_suggestion
    tips: none

# æ¨™é»ç¬¦è™Ÿ
  punctuator/full_shape:
    "/" : ["/", "ï½¤", "Ã·"]
  punctuator/half_shape:
    "#": "#"
    "$": "ï¿¥"
    "%": "%"
    "*": "*"
    "/" : ["/", "ï½¤", "Ã·"]
    "<": "ã€Š"
    "=": "="
    ">": "ã€‹"
    "@": "@"
    "[": "ã€"
    "\\": "ã€"
    "]": "ã€‘"
    "`": "`"
    "{": ["ã€Œ", "ã€"]
    "|": "|"
    "}": ["ã€", "ã€"]
    "~": "~"

  punctuator/import_preset: symbols
  punctuator/symbols:
    "/bq" : [ğŸ˜€, ğŸ™‚, ğŸ™, ğŸ˜‚, ğŸ˜­, ğŸ˜, ğŸ˜˜, ğŸ™„, ğŸ˜Š, ğŸ¤”, ğŸ˜œ, ğŸ˜, ğŸ˜‹, ğŸ˜, ğŸ˜Œ, ğŸ˜·, ğŸ˜¡, ğŸ˜ˆ]
    "/key" : [âŒ˜, â‡§, âŒ¥, âŒƒ, â†©ï¸, âŒ«, âŒ¦, â†‘, â†“, â†, â†’, â‡, â‡Ÿ, â†–, â†˜, â‡¥, â‡¤, â‹]

# æœ™æœˆæ‹¼éŸ³æ“´å……è©åº«
  # è¼‰å…¥æœ™æœˆæ‹¼éŸ³æ“´å……è©åº«
  "translator/dictionary": luna_pinyin.extended
  # æ”¹å¯«æ‹¼å¯«é‹ç®—ï¼Œä½¿å¾—å«è¥¿æ–‡çš„è©å½™ï¼ˆä½æ–¼ luna_pinyin.cn_en.dict.yaml ä¸­ï¼‰ä¸å½±éŸ¿ç°¡æ‹¼åŠŸèƒ½ï¼ˆæ³¨æ„ï¼Œæ­¤åŠŸèƒ½åªé©ç”¨æ–¼æœ™æœˆæ‹¼éŸ³ç³»åˆ—æ–¹æ¡ˆï¼Œä¸é©ç”¨æ–¼å„é¡é›™æ‹¼æ–¹æ¡ˆï¼‰
  # æœ¬æ¢è£œéªåªåœ¨ã€Œé¼ é¬šç®¡ 0.9.25 ã€åŠæ›´é«˜çš„ç‰ˆæœ¬ä¸­èµ·ä½œç”¨ã€‚
  "speller/algebra/@before 0": xform/^([b-df-hj-np-tv-z])$/$1_/

# æ¨¡ç³ŠéŸ³è®¾ç½®
  'speller/algebra':
    - erase/^xx$/                      # ç¬¬ä¸€è¡Œä¿ç•™

    # æ¨¡ç³ŠéŸ³å®šç¾©
    # éœ€è¦å“ªçµ„å°±åˆªå»è¡Œé¦–çš„ # è™Ÿï¼Œå–®é›™å‘ä»»é¸
    #- derive/^([zcs])h/$1/             # zh, ch, sh => z, c, s
    #- derive/^([zcs])([^h])/$1h$2/     # z, c, s => zh, ch, sh

    #- derive/^n/l/                     # n => l
    #- derive/^l/n/                     # l => n

    # é€™å…©çµ„ä¸€èˆ¬æ˜¯å–®å‘çš„
    #- derive/^r/l/                     # r => l

    #- derive/^ren/yin/                 # ren => yin, reng => ying
    #- derive/^r/y/                     # r => y

    # ä¸‹é¢ hu <=> f é€™çµ„å¯«æ³•è¤‡é›œä¸€äº›ï¼Œåˆ†æƒ…æ³è¨è«–
    #- derive/^hu$/fu/                  # hu => fu
    #- derive/^hong$/feng/              # hong => feng
    #- derive/^hu([in])$/fe$1/          # hui => fei, hun => fen
    #- derive/^hu([ao])/f$1/            # hua => fa, ...

    #- derive/^fu$/hu/                  # fu => hu
    #- derive/^feng$/hong/              # feng => hong
    #- derive/^fe([in])$/hu$1/          # fei => hui, fen => hun
    #- derive/^f([ao])/hu$1/            # fa => hua, ...

    # éŸ»æ¯éƒ¨ä»½
    #- derive/^([bpmf])eng$/$1ong/      # meng = mong, ...
    #- derive/([ei])n$/$1ng/            # en => eng, in => ing
    #- derive/([ei])ng$/$1n/            # eng => en, ing => in

    # æ¨£ä¾‹è¶³å¤ äº†ï¼Œå…¶ä»–è«‹è‡ªå·±ç¸½çµâ€¦â€¦

    # åæ¨¡ç³ŠéŸ³ï¼Ÿ
    # èª°èªªæ–¹è¨€æ²’æœ‰æ™®é€šè©±ç²¾ç¢ºã€æœ‰æ¨¡ç³ŠéŸ³ï¼Œå°±èƒ½æœ‰åæ¨¡ç³ŠéŸ³ã€‚
    # ç¤ºä¾‹çˆ²åˆ†å°–åœ˜çš„ä¸­åŸå®˜è©±ï¼š
    #- derive/^ji$/zii/   # åœ¨è¨­è¨ˆè€…å®‰æ’ä¸‹é³©ä½”éµ²å·¢ï¼Œå°–éŸ³iåªå¥½é›™å¯«äº†
    #- derive/^qi$/cii/
    #- derive/^xi$/sii/
    #- derive/^ji/zi/
    #- derive/^qi/ci/
    #- derive/^xi/si/
    #- derive/^ju/zv/
    #- derive/^qu/cv/
    #- derive/^xu/sv/
    # éŸ»æ¯éƒ¨ä»½ï¼Œåªèƒ½å¾å¤§é¢ä¸Šè¦†è“‹
    #- derive/^([bpm])o$/$1eh/          # bo => beh, ...
    #- derive/(^|[dtnlgkhzcs]h?)e$/$1eh/  # ge => geh, se => sheh, ...
    #- derive/^([gkh])uo$/$1ue/         # guo => gue, ...
    #- derive/^([gkh])e$/$1uo/          # he => huo, ...
    #- derive/([uv])e$/$1o/             # jue => juo, lve => lvo, ...
    #- derive/^fei$/fi/                 # fei => fi
    #- derive/^wei$/vi/                 # wei => vi
    #- derive/^([nl])ei$/$1ui/          # nei => nui, lei => lui
    #- derive/^([nlzcs])un$/$1vn/       # lun => lvn, zun => zvn, ... 
    #- derive/^([nlzcs])ong$/$1iong/    # long => liong, song => siong, ...
    # é€™å€‹è¾¦æ³•é›–å¾æ‹¼å¯«ä¸Šåšå‡ºäº†å€åˆ†ï¼Œç„¶è€Œå—è©å…¸åˆ¶ç´„ï¼Œå€™é¸å­—ä»æ˜¯æ··çš„ã€‚
    # åªæœ‰çœŸæ­£çš„æ–¹éŸ³è¼¸å…¥æ–¹æ¡ˆçº”èƒ½åšåˆ°ï¼ä½†ã€Œåæ¨¡ç³ŠéŸ³ã€é€™å€‹ç©æ³•å¿«é€Ÿè€Œæœ‰æ•ˆï¼

    # æ¨¡ç³ŠéŸ³å®šç¾©å…ˆæ–¼ç°¡æ‹¼å®šç¾©ï¼Œæ–¹å¯ä»¤ç°¡æ‹¼æ”¯æŒä»¥ä¸Šæ¨¡ç³ŠéŸ³
    - abbrev/^([a-z]).+$/$1/           # ç°¡æ‹¼ï¼ˆé¦–å­—æ¯ï¼‰
    - abbrev/^([zcs]h).+$/$1/          # ç°¡æ‹¼ï¼ˆzh, ch, shï¼‰

    # ä»¥ä¸‹æ˜¯ä¸€çµ„å®¹éŒ¯æ‹¼å¯«ï¼Œã€Šæ¼¢èªæ‹¼éŸ³ã€‹æ–¹æ¡ˆä»¥å‰è€…çˆ²æ­£
    #- derive/^([nl])ve$/$1ue/          # nve = nue, lve = lue
    #- derive/^([jqxy])u/$1v/           # ju = jv,
    #- derive/un$/uen/                  # gun = guen,
    #- derive/ui$/uei/                  # gui = guei,
    #- derive/iu$/iou/                  # jiu = jiou,

    # è‡ªå‹•ç³¾æ­£ä¸€äº›å¸¸è¦‹çš„æŒ‰éµéŒ¯èª¤
    #- derive/([aeiou])ng$/$1gn/        # dagn => dang 
    #- derive/([dtngkhrzcs])o(u|ng)$/$1o/  # zho => zhong|zhou
    #- derive/ong$/on/                  # zhonguo => zhong guo
    #- derive/ao$/oa/                   # hoa => hao
    #- derive/([iu])a(o|ng?)$/a$1$2/    # tain => tian

  # åˆ†å°–åœ˜å¾Œ v => Ã¼ çš„æ”¹å¯«æ¢ä»¶ä¹Ÿè¦ç›¸æ‡‰åœ°æ“´å……ï¼š
  #'translator/preedit_format':
  #  - "xform/([nljqxyzcs])v/$1Ã¼/"
